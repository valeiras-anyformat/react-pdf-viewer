"use strict";var e=require("@react-pdf-viewer/core");function t(e){var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var n=t(require("react"));var i="rpv_5990c52b",r="rpv_7ca882b5",o=(e=>(e.NoSelection="NoSelection",e.Selecting="Selecting",e.Selected="Selected",e.Selection="Selection",e.ClickDragging="ClickDragging",e.ClickDragged="ClickDragged",e))(o||{});
/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2024 Nguyen Huu Phuoc <me@phuoc.ng>
 */const a={height:0,left:0,pageIndex:-1,top:0,width:0},s={highlightAreas:[],selectionRegion:a,type:"NoSelection"},g={highlightAreas:[],selectionRegion:a,type:"Selecting"},l=({canvasLayerRef:e,canvasLayerRendered:t,pageIndex:a,store:g,textLayerRef:l,textLayerRendered:c})=>{const h=n.useRef(null),d=n.useRef(document.body.style.cursor),u=n.useRef({x:0,y:0}),p=n.useRef({top:0,left:0}),f=()=>{const e=h.current;e&&e.classList.add(r)},m=e=>{const t=l.current,n=h.current;if(!e.altKey||!t||!n||0!==e.button)return;e.preventDefault(),document.body.style.cursor="crosshair";const i=t.getBoundingClientRect(),r={x:e.clientX,y:e.clientY};u.current=r;const a={top:100*(r.y-i.top)/i.height,left:100*(r.x-i.left)/i.width};p.current=a,n.style.top=`${a.top}%`,n.style.left=`${a.left}%`,n.style.height="0px",n.style.width="0px",document.addEventListener("mousemove",x),document.addEventListener("mouseup",y),g.updateCurrentValue("highlightState",(e=>Object.assign({},e,{type:o.ClickDragging})))},x=e=>{const t=l.current,n=h.current;if(!t||!n)return;e.preventDefault();const i=e.clientX-u.current.x,o=e.clientY-u.current.y,a=t.getBoundingClientRect();n.classList.contains(r)&&n.classList.remove(r);const s=Math.min(100-p.current.left,100*i/a.width),g=Math.min(100-p.current.top,100*o/a.height);n.style.width=`${s}%`,n.style.height=`${g}%`},v=e=>{"Escape"===e.key&&g.get("highlightState").type===o.ClickDragged&&(e.preventDefault(),f(),g.update("highlightState",s))},w=e=>{const t=h.current;if(!t)return;g.get("highlightState").type===o.NoSelection&&e.target!==t&&f()},y=t=>{t.preventDefault(),document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",y),S();const n=h.current,i=e.current;if(!n||!i)return;const r={pageIndex:a,top:parseFloat(n.style.top.slice(0,-1)),left:parseFloat(n.style.left.slice(0,-1)),height:parseFloat(n.style.height.slice(0,-1)),width:parseFloat(n.style.width.slice(0,-1))},s=(()=>{const e=document.createElement("canvas"),t=window.devicePixelRatio||1;return(n,i)=>{const r=n.getBoundingClientRect(),o=i.left*r.width/100,a=i.top*r.height/100,s=i.width*r.width/100,g=i.height*r.height/100,l=e.getContext("2d");return e.width=s,e.height=g,l?.drawImage(n,o*t,a*t,s*t,g*t,0,0,s,g),e.toDataURL("image/png")}})()(i,r),l={highlightAreas:[r],previewImage:s,selectionRegion:r,type:o.ClickDragged};g.update("highlightState",l)},S=()=>{d.current?document.body.style.cursor=d.current:document.body.style.removeProperty("cursor")},b=e=>{(e.type===o.Selection||e.type===o.ClickDragging&&e.selectionRegion.pageIndex!==a)&&f()};return n.useEffect((()=>(g.subscribe("highlightState",b),()=>{g.unsubscribe("highlightState",b)})),[]),n.useEffect((()=>{const n=e.current,i=l.current;if(!(t&&c&&n&&i))return;i.addEventListener("mousedown",m);const r={capture:!0};return document.addEventListener("keydown",v),document.addEventListener("click",w,r),()=>{i.removeEventListener("mousedown",m),document.removeEventListener("click",w,r),document.removeEventListener("keydown",v)}}),[c]),n.createElement("div",{ref:h,className:`${i} ${r}`})};var c="rpv_e1c7cdad",h="rpv_59dcf05b";
/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2024 Nguyen Huu Phuoc <me@phuoc.ng>
 */const d=e=>e>=0?e:360+e,u=(e,t)=>{switch(d(t)){case 90:return{height:`${e.width}%`,position:"absolute",right:`${e.top}%`,top:`${e.left}%`,width:`${e.height}%`};case 180:return{bottom:`${e.top}%`,height:`${e.height}%`,position:"absolute",right:`${e.left}%`,width:`${e.width}%`};case 270:return{height:`${e.width}%`,position:"absolute",left:`${e.top}%`,bottom:`${e.left}%`,width:`${e.height}%`};default:return{height:`${e.height}%`,position:"absolute",top:`${e.top}%`,left:`${e.left}%`,width:`${e.width}%`}}},p=({area:e,rotation:t})=>n.createElement("div",{className:c,style:u(e,t)}),f=e=>{const[t,i]=n.useState(e.get("rotation")||0),r=e=>i(e);return n.useEffect((()=>(e.subscribe("rotation",r),()=>{e.unsubscribe("rotation",r)})),[]),{rotation:t}},m=({pageIndex:e,renderHighlightContent:t,renderHighlightTarget:i,renderHighlights:r,store:a})=>{const[g,l]=n.useState(a.get("highlightState")),{rotation:c}=f(a),h=e=>l(e),d=()=>{window.getSelection()?.removeAllRanges(),a.update("highlightState",s)};n.useEffect((()=>(a.subscribe("highlightState",h),()=>{a.unsubscribe("highlightState",h)})),[]);const m=g.type===o.Selection?g.highlightAreas.filter((t=>t.pageIndex===e)):[];return n.createElement(n.Fragment,null,i&&(g.type===o.Selected||g.type===o.ClickDragged)&&g.selectionRegion.pageIndex===e&&i({highlightAreas:g.highlightAreas,previewImage:g.previewImage||"",selectedText:g.selectedText||"",selectionRegion:g.selectionRegion,selectionData:g.selectionData,cancel:d,toggle:()=>{const e=Object.assign({},g,{type:o.Selection});a.update("highlightState",e),window.getSelection()?.removeAllRanges()}}),t&&g.type==o.Selection&&g.selectionRegion.pageIndex===e&&t({highlightAreas:g.highlightAreas,previewImage:g.previewImage||"",selectedText:g.selectedText||"",selectionRegion:g.selectionRegion,selectionData:g.selectionData,cancel:d}),m.length>0&&n.createElement("div",null,m.map(((e,t)=>n.createElement(p,{key:t,area:e,rotation:c})))),r&&r({pageIndex:e,rotation:c,getCssProperties:u}))},x="data-highlight-text-layer",v="data-highlight-text-page",w=(e,t,n)=>{const i=e.cloneNode(!0);e.parentNode.appendChild(i);const r=i.firstChild,o=new Range;o.setStart(r,t),o.setEnd(r,n);const a=document.createElement("span");o.surroundContents(a);const s=a.getBoundingClientRect();return i.parentNode.removeChild(i),s},y=(e,t,n,i,r,o)=>{if(n<r){const a=`${e.slice(n,n+1).map((e=>e.textContent.substring(i).trim())).join(" ")} ${e.slice(n+1,r).map((e=>e.textContent.trim())).join(" ")} ${e.slice(r,r+1).map((e=>e.textContent.substring(0,o||e.textContent.length))).join(" ")}`;return{divTexts:e.slice(n,r+1).map(((e,i)=>({divIndex:n+i,pageIndex:t,textContent:e.textContent}))),wholeText:a}}{const r=e[n],a=r.textContent.substring(i,o||r.textContent.length).trim();return{divTexts:[{divIndex:n,pageIndex:t,textContent:r.textContent}],wholeText:a}}};
/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2024 Nguyen Huu Phuoc <me@phuoc.ng>
 */
var S=(e=>(e.SameDiv="SameDiv",e.DifferentDivs="DifferentDivs",e.DifferentPages="DifferentPages",e))(S||{}),b=(e=>(e.None="None",e.TextSelection="TextSelection",e))(b||{});
/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2024 Nguyen Huu Phuoc <me@phuoc.ng>
 */const C=["","\n"],E=({store:e})=>{const{rotation:t}=f(e),i=n.useRef(null),[r,a]=n.useState(!1),[s,g]=n.useState(e.get("trigger")),l=e=>{const t=e();i.current=t,a(!!t)},c=e=>g(e),h=()=>{const n=document.getSelection(),i=e.get("highlightState");if(!((i.type===o.NoSelection||i.type===o.Selected)&&n.rangeCount>0&&-1===C.indexOf(n.toString())))return;const r=n.getRangeAt(0),a=r.startContainer.parentNode,s=r.endContainer.parentNode,g=s instanceof HTMLElement&&s.hasAttribute(x);let l,c;if(a&&a.parentNode==r.endContainer?(l=a,c=l.textContent.length):g&&0==r.endOffset?(l=r.endContainer.previousSibling,c=l.textContent.length):g?(l=r.endContainer,c=r.endOffset):(l=s,c=r.endOffset),!(a instanceof HTMLElement&&l instanceof HTMLElement))return;const h=parseInt(a.getAttribute(v)||"",10),u=parseInt(l.getAttribute(v)||"",10),p=a.parentElement,f=l.parentElement,m=p.getBoundingClientRect(),b=[].slice.call(p.querySelectorAll(`[${v}]`)),E=b.indexOf(a),R=f.getBoundingClientRect(),D=[].slice.call(f.querySelectorAll(`[${v}]`)),I=D.indexOf(l),L=r.startOffset;let T=S.DifferentPages;switch(!0){case h===u&&E===I:T=S.SameDiv;break;case h===u&&E<I:T=S.DifferentDivs;break;default:T=S.DifferentPages}const $=(e,t,n)=>Array(t-e+1).fill(0).map(((t,i)=>n[e+i].getBoundingClientRect()));let A=[];switch(T){case S.SameDiv:const e=w(a,L,c);A=[{height:100*e.height/m.height,left:100*(e.left-m.left)/m.width,pageIndex:h,top:100*(e.top-m.top)/m.height,width:100*e.width/m.width}];break;case S.DifferentDivs:A=[w(a,L,a.textContent.length)].concat($(E+1,I-1,b)).concat([w(l,0,c)]).map((e=>({height:100*e.height/m.height,left:100*(e.left-m.left)/m.width,pageIndex:h,top:100*(e.top-m.top)/m.height,width:100*e.width/m.width})));break;case S.DifferentPages:const t=[w(a,L,a.textContent.length)].concat($(E+1,b.length-1,b)).map((e=>({height:100*e.height/m.height,left:100*(e.left-m.left)/m.width,pageIndex:h,top:100*(e.top-m.top)/m.height,width:100*e.width/m.width}))),n=$(0,I-1,D).concat([w(l,0,c)]).map((e=>({height:100*e.height/R.height,left:100*(e.left-R.left)/R.width,pageIndex:u,top:100*(e.top-R.top)/R.height,width:100*e.width/R.width})));A=t.concat(n)}let k,P="",O=[];switch(T){case S.SameDiv:const e=y(b,h,E,L,E,c);P=e.wholeText,O=e.divTexts;break;case S.DifferentDivs:const t=y(b,h,E,L,I,c);P=t.wholeText,O=t.divTexts;break;case S.DifferentPages:const n=y(b,h,E,L,b.length),i=y(D,u,0,0,I,c);P=`${n.wholeText}\n${i.wholeText}`,O=n.divTexts.concat(i.divTexts)}if(A.length>0)k=A[A.length-1];else{const e=l.getBoundingClientRect();k={height:100*e.height/R.height,left:100*(e.left-R.left)/R.width,pageIndex:u,top:100*(e.top-R.top)/R.height,width:100*e.width/R.width}}const N={divTexts:O,selectedText:P,startPageIndex:h,endPageIndex:u,startOffset:L,startDivIndex:E,endOffset:c,endDivIndex:I},j={type:o.Selected,selectedText:P,highlightAreas:A.map((e=>((e,t)=>{switch(d(t)){case 90:return{height:e.width,left:e.top,pageIndex:e.pageIndex,top:100-e.width-e.left,width:e.height};case 180:return{height:e.height,left:100-e.width-e.left,pageIndex:e.pageIndex,top:100-e.height-e.top,width:e.width};case 270:return{height:e.width,left:100-e.height-e.top,pageIndex:e.pageIndex,top:e.left,width:e.height};default:return e}})(e,t))),selectionData:N,selectionRegion:k};e.update("highlightState",j)};return n.useEffect((()=>{const e=i.current;if(e&&s!==b.None)return e.addEventListener("mouseup",h),()=>{e.removeEventListener("mouseup",h)}}),[r,s,t]),n.useEffect((()=>(e.subscribe("getPagesContainer",l),e.subscribe("trigger",c),()=>{e.unsubscribe("getPagesContainer",l),e.unsubscribe("trigger",c)})),[]),n.createElement(n.Fragment,null)},R=h;exports.MessageIcon=()=>n.createElement(e.Icon,{size:16},n.createElement("path",{d:"M23.5,17a1,1,0,0,1-1,1h-11l-4,4V18h-6a1,1,0,0,1-1-1V3a1,1,0,0,1,1-1h21a1,1,0,0,1,1,1Z"}),n.createElement("path",{d:"M5.5 12L18.5 12"}),n.createElement("path",{d:"M5.5 7L18.5 7"}))
/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2024 Nguyen Huu Phuoc <me@phuoc.ng>
 */,exports.Trigger=b,exports.highlightPlugin=t=>{const i=Object.assign({},{trigger:b.TextSelection},t),r=n.useMemo((()=>e.createStore({highlightState:s,trigger:i.trigger})),[]);return{install:e=>{r.update("jumpToDestination",e.jumpToDestination),r.update("getPagesContainer",e.getPagesContainer)},onViewerStateChange:e=>(r.update("rotation",e.rotation),e),onTextLayerRender:t=>{const n=(i=t,e=>{if(r.get("trigger")===b.None||0!==e.button)return;const t=i.ele,n=t.getBoundingClientRect(),a=r.get("highlightState");if(!a)return;if(a.type===o.Selected){const t=e.clientY-n.top,o=e.clientX-n.left;a.highlightAreas.filter((e=>e.pageIndex===i.pageIndex)).find((e=>{const i=e.top*n.height/100,r=e.left*n.width/100,a=e.height*n.height/100,s=e.width*n.width/100;return i<=t&&t<=i+a&&r<=o&&o<=r+s}))?(window.getSelection()?.removeAllRanges(),r.update("highlightState",s)):r.update("highlightState",g)}else r.update("highlightState",s);const l=100*(e.clientY-n.top)/n.height,c=t.querySelector(`.${R}`);c&&e.target!==t&&(c.style.top=`${Math.max(0,l)}%`)});var i;const a=(e=>t=>{if(r.get("trigger")===b.None)return;const n=e.ele.querySelector(`.${R}`);n&&n.style.removeProperty("top")})(t),l=t.ele;if(t.status===e.LayerRenderStatus.PreRender){l.removeEventListener("mousedown",n),l.removeEventListener("mouseup",a);const e=l.querySelector(`.${R}`);e&&l.removeChild(e)}else if(t.status===e.LayerRenderStatus.DidRender&&(l.addEventListener("mousedown",n),l.addEventListener("mouseup",a),l.setAttribute(x,"true"),l.querySelectorAll(".rpv-core__text-layer-text").forEach((e=>e.setAttribute(v,`${t.pageIndex}`))),!l.querySelector(`.${R}`))){const e=document.createElement("div");e.classList.add(R),e.setAttribute("data-text","false"),l.appendChild(e)}},renderPageLayer:e=>n.createElement(n.Fragment,null,n.createElement(l,{canvasLayerRef:e.canvasLayerRef,canvasLayerRendered:e.canvasLayerRendered,pageIndex:e.pageIndex,store:r,textLayerRef:e.textLayerRef,textLayerRendered:e.textLayerRendered}),n.createElement(m,{pageIndex:e.pageIndex,renderHighlightContent:i.renderHighlightContent,renderHighlightTarget:i.renderHighlightTarget,renderHighlights:i.renderHighlights,store:r})),renderViewer:e=>{const t=e.slot;return t.subSlot&&t.subSlot.children&&(t.subSlot.children=n.createElement(n.Fragment,null,n.createElement(E,{store:r}),t.subSlot.children)),t},jumpToHighlightArea:e=>{const t=r.get("jumpToDestination");if(t){const n=(t,n)=>(100-e.top)*n/100,i=(t,n)=>(100-e.left)*t/100;t({pageIndex:e.pageIndex,bottomOffset:n,leftOffset:i})}},switchTrigger:e=>{r.update("trigger",e)}}};
