"use strict";var e=require("@react-pdf-viewer/core");function t(e){var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var n=t(require("react"));
/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2024 Nguyen Huu Phuoc <me@phuoc.ng>
 */var a="rpv_74ff328a",c="rpv_d9b8b80",r="rpv_74fdfcff";const o=({files:t})=>{const o=n.useRef(null),{l10n:s}=n.useContext(e.LocalizationContext),{direction:i}=n.useContext(e.ThemeContext),l=i===e.TextDirection.RightToLeft,u=n.useRef([]),d=s&&s.attachment?s.attachment.clickToDownload:"Click to download",f=e=>{const t=o.current,n=[].slice.call(t.getElementsByClassName(r));if(0===n.length)return;n.forEach((e=>e.setAttribute("tabindex","-1")));const a=document.activeElement,c=n[Math.min(n.length-1,Math.max(0,e(n,a)))];c.setAttribute("tabindex","0"),c.focus()};return e.useIsomorphicLayoutEffect((()=>{const e=o.current;if(!e)return;const t=[].slice.call(e.getElementsByClassName(r));if(u.current=t,t.length>0){const e=t[0];e.focus(),e.setAttribute("tabindex","0")}}),[]),n.createElement("div",{"data-testid":"attachment__list",className:e.classNames({[a]:!0,[c]:l}),ref:o,tabIndex:-1,onKeyDown:e=>{switch(e.key){case"ArrowDown":e.preventDefault(),f(((e,t)=>e.indexOf(t)+1));break;case"ArrowUp":e.preventDefault(),f(((e,t)=>e.indexOf(t)-1));break;case"End":e.preventDefault(),f(((e,t)=>e.length-1));break;case"Home":e.preventDefault(),f(((e,t)=>0))}}},t.map((e=>n.createElement("button",{className:r,key:e.fileName,tabIndex:-1,title:d,type:"button",onClick:()=>((e,t)=>{const n="string"==typeof t?"":URL.createObjectURL(new Blob([t],{type:""})),a=document.createElement("a");a.style.display="none",a.href=n||e,a.setAttribute("download",(e=>{const t=e.split("/").pop();return t?t.split("#")[0].split("?")[0]:e})(e)),document.body.appendChild(a),a.click(),document.body.removeChild(a),n&&URL.revokeObjectURL(n)})(e.fileName,e.data)},e.fileName))))};var s="rpv_a9033fd6",i="rpv_3122eab4";const l=({doc:t})=>{const{l10n:a}=n.useContext(e.LocalizationContext),{direction:c}=n.useContext(e.ThemeContext),r=c===e.TextDirection.RightToLeft,l=a&&a.attachment?a.attachment.noAttachment:"There is no attachment",[u,d]=n.useState({files:[],isLoaded:!1});return n.useEffect((()=>{t.getAttachments().then((e=>{const t=e?Object.keys(e).map((t=>({data:e[t].content,fileName:e[t].filename}))):[];d({files:t,isLoaded:!0})}))}),[t]),u.isLoaded?0===u.files.length?n.createElement("div",{"data-testid":"attachment__empty",className:e.classNames({[s]:!0,[i]:r})},l):n.createElement(o,{files:u.files}):n.createElement(e.Spinner,null)};var u="rpv_fdd432ce";const d=({store:t})=>{const[a,c]=n.useState(t.get("doc")),r=e=>{c(e)};return n.useEffect((()=>(t.subscribe("doc",r),()=>{t.unsubscribe("doc",r)})),[]),a?n.createElement(l,{doc:a}):n.createElement("div",{className:u},n.createElement(e.Spinner,null))};exports.attachmentPlugin=()=>{const t=n.useMemo((()=>e.createStore({})),[]);return{onDocumentLoad:e=>{t.update("doc",e.doc)},Attachments:()=>n.createElement(d,{store:t})}};
