"use strict";var e=require("@react-pdf-viewer/core");function t(e){var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var r=t(require("react"));const n=()=>r.createElement(e.Icon,{size:16},r.createElement("path",{d:"M0.541,5.627L11.666,18.2c0.183,0.207,0.499,0.226,0.706,0.043c0.015-0.014,0.03-0.028,0.043-0.043\n            L23.541,5.627"})),a=()=>r.createElement(e.Icon,{size:16},r.createElement("path",{d:"M23.535,18.373L12.409,5.8c-0.183-0.207-0.499-0.226-0.706-0.043C11.688,5.77,11.674,5.785,11.66,5.8\n            L0.535,18.373"})),o=()=>r.createElement(e.Icon,{ignoreDirection:!0,size:16},r.createElement("path",{d:"M10.5,0.5c5.523,0,10,4.477,10,10s-4.477,10-10,10s-10-4.477-10-10S4.977,0.5,10.5,0.5z\n            M23.5,23.5\n            l-5.929-5.929"}))
/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2024 Nguyen Huu Phuoc <me@phuoc.ng>
 */,s=e=>({left:`${e.left}%`,top:`${e.top}%`,height:`${e.height}%`,width:`${e.width}%`});var c="rpv_5852b0f8",l="rpv_a802aadb",i="rpv_bd8fce1e";const u=({index:t,area:n,onHighlightKeyword:a})=>{const o=r.useRef(null);return e.useIsomorphicLayoutEffect((()=>{const e=o.current;a&&e&&a({highlightEle:e,keyword:n.keyword})}),[]),r.createElement("div",{className:l,"data-index":t,ref:o,style:s(n),title:n.keywordStr.trim()})},d={keyword:"",regExp:new RegExp(" "),wholeWords:!1},h=e=>{const t=e.parentNode;t&&t.removeChild(e)},g=e=>{const t=e.parentNode;if(!t)return;const r=document.createRange();r.selectNodeContents(e),((e,t)=>{h(e);const r=t.parentNode;r&&r.insertBefore(e,t),h(t)})(r.extractContents(),e),t.normalize()},m=(e,t)=>e.top<t.top?-1:e.top>t.top?1:e.left<t.left?-1:e.left>t.left?1:0,p=({numPages:t,pageIndex:n,renderHighlights:a,store:o,onHighlightKeyword:h})=>{const p=r.useRef(null),f=r.useCallback((e=>r.createElement(r.Fragment,null,e.highlightAreas.map(((e,t)=>r.createElement(u,{index:t,key:t,area:e,onHighlightKeyword:h}))))),[]),x=a||f,[y,E]=r.useState(o.get("matchPosition")),[w,b]=r.useState(o.get("keyword")||[d]),[v,k]=r.useState({pageIndex:n,scale:1,status:e.LayerRenderStatus.PreRender}),S=r.useRef(null),C=r.useRef([]),[P,I]=r.useState([]),T=()=>!0,M=r.useCallback((()=>o.get("targetPageFilter")||T),[o.get("targetPageFilter")]),R=e=>{const r=C.current;if(0===r.length)return[];const a=[],o=[].slice.call(e.querySelectorAll('[data-text="true"]')),s=r.map((e=>e.char)).join("");return w.forEach((c=>{const l=c.keyword;if(!l.trim())return;const i=-1===c.regExp.flags.indexOf("g")?new RegExp(c.regExp,`${c.regExp.flags}g`):c.regExp;let u;const d=[];for(;null!==(u=i.exec(s));)d.push({keyword:i,startIndex:u.index,endIndex:i.lastIndex});d.map((e=>({keyword:e.keyword,indexes:r.slice(e.startIndex,e.endIndex)}))).forEach((r=>{const s=r.indexes.reduce(((e,t)=>(e[t.spanIndex]=(e[t.spanIndex]||[]).concat([t]),e)),{});Object.values(s).forEach((s=>{if(1!==s.length||""!==s[0].char.trim()){const i=c.wholeWords?s.slice(1,-1):s,u=((e,r,a,o,s)=>{const c=document.createRange(),l=o.firstChild;if(!l||l.nodeType!==Node.TEXT_NODE)return null;const i=l.textContent.length,u=s[0].charIndexInSpan,d=1===s.length?u:s[s.length-1].charIndexInSpan;if(u>i||d+1>i)return null;c.setStart(l,u),c.setEnd(l,d+1);const h=document.createElement("span");c.surroundContents(h);const m=h.getBoundingClientRect(),p=a.getBoundingClientRect(),f=p.height,x=p.width,y=100*(m.left-p.left)/x,E=100*(m.top-p.top)/f,w=100*m.height/f,b=100*m.width/x;return g(h),{keyword:r,keywordStr:e,numPages:t,pageIndex:n,left:y,top:E,height:w,width:b,pageHeight:f,pageWidth:x}})(l,r.keyword,e,o[i[0].spanIndex],i);u&&a.push(u)}}))}))})),a.sort(m)},L=e=>{e&&e.length>0&&b(e)},N=e=>E(e),_=e=>{if(!e.has(n))return;const t=e.get(n);t&&k({ele:t.ele,pageIndex:n,scale:t.scale,status:t.status})},j=()=>0===w.length||1===w.length&&""===w[0].keyword.trim();return r.useEffect((()=>{const t=v.ele;if(j()||v.status!==e.LayerRenderStatus.DidRender||C.current.length||!t)return;const r=[].slice.call(t.querySelectorAll('[data-text="true"]')).map((e=>e.textContent)).reduce(((e,t,r)=>e.concat(t.split("").map(((e,t)=>({char:e,charIndexInSpan:t,spanIndex:r}))))),[{char:"",charIndexInSpan:0,spanIndex:0}]).slice(1);C.current=r}),[w,v.status]),r.useEffect((()=>{if(j()||!v.ele||v.status!==e.LayerRenderStatus.DidRender||!M()({pageIndex:n,numPages:t}))return;const r=v.ele,a=R(r);I(a)}),[w,y,v.status,C.current]),r.useEffect((()=>{j()&&v.ele&&v.status===e.LayerRenderStatus.DidRender&&I([])}),[w,v.status]),r.useEffect((()=>{if(0===P.length)return;const t=p.current;if(y.pageIndex!==n||!t||v.status!==e.LayerRenderStatus.DidRender)return;const r=t.querySelector(`.${l}[data-index="${y.matchIndex}"]`);if(!r)return;const{left:a,top:s}=((e,t)=>{let r=e.offsetTop,n=e.offsetLeft,a=e.parentElement;for(;a&&a!==t;)r+=a.offsetTop,n+=a.offsetLeft,a=a.parentElement;return{left:n,top:r}})(r,t),c=o.get("jumpToDestination");c&&(c({pageIndex:n,bottomOffset:(t.getBoundingClientRect().height-s)/v.scale,leftOffset:a/v.scale,scaleTo:v.scale}),S.current&&S.current.classList.remove(i),S.current=r,r.classList.add(i))}),[P,y]),r.useEffect((()=>(o.subscribe("keyword",L),o.subscribe("matchPosition",N),o.subscribe("renderStatus",_),()=>{o.unsubscribe("keyword",L),o.unsubscribe("matchPosition",N),o.unsubscribe("renderStatus",_)})),[]),r.createElement("div",{className:c,"data-testid":`search__highlights-${n}`,ref:p},x({getCssProperties:s,highlightAreas:P}))},f=e=>{const t=e.wholeWords?` ${e.keyword} `:e.keyword,r=e.matchCase?"g":"gi";return{keyword:e.keyword,regExp:new RegExp((n=t,n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")),r),wholeWords:e.wholeWords||!1};var n},x=(e,t,r)=>e instanceof RegExp?{keyword:e.source,regExp:e,wholeWords:r||!1}:"string"==typeof e?""===e?d:f({keyword:e,matchCase:t||!1,wholeWords:r||!1}):(void 0!==t&&(e.matchCase=t),void 0!==r&&(e.wholeWords=r),f(e)),y=t=>{const n=t.get("initialKeyword"),a=r.useMemo((()=>{if(n&&1===n.length){const e=x(n[0]);return{matchCase:-1===e.regExp.flags.indexOf("i"),wholeWords:e.wholeWords}}return{matchCase:!1,wholeWords:!1}}),[]),o=(e=>{const t=r.useRef(e.get("doc")),n=e=>{t.current=e};return r.useEffect((()=>(e.subscribe("doc",n),()=>{e.unsubscribe("doc",n)})),[]),t})(t),[s,c]=r.useState(n),[l,i]=r.useState([]),[u,h]=r.useState(0),[g,m]=r.useState(a.matchCase),p=r.useRef([]),[f,y]=r.useState(a.wholeWords),E=()=>!0,w=r.useCallback((()=>t.get("targetPageFilter")||E),[t.get("targetPageFilter")]),b=e=>{const t=l.length;if(0===s.length||0===t)return null;const r=e===t+1?1:Math.max(1,Math.min(t,e));return h(r),k(l[r-1])},v=e=>c(""===e?[]:[e]),k=e=>{const r=t.get("jumpToPage");return r&&r(e.pageIndex),t.update("matchPosition",{matchIndex:e.matchIndex,pageIndex:e.pageIndex}),e},S=(r,n,a)=>{const s=o.current;if(!s)return Promise.resolve([]);const c=s.numPages,l=r.map((e=>x(e,n,a)));return t.update("keyword",l),h(0),i([]),new Promise(((t,r)=>{const n=0===p.current.length?(()=>{const t=o.current;if(!t)return Promise.resolve([]);const r=Array(t.numPages).fill(0).map(((r,n)=>e.getPage(t,n).then((e=>e.getTextContent())).then((e=>{const t=e.items.map((e=>e.str||"")).join("");return Promise.resolve({pageContent:t,pageIndex:n})}))));return Promise.all(r).then((e=>(e.sort(((e,t)=>e.pageIndex-t.pageIndex)),Promise.resolve(e.map((e=>e.pageContent))))))})().then((e=>(p.current=e,Promise.resolve(e)))):Promise.resolve(p.current);n.then((e=>{const r=[];e.forEach(((e,t)=>{w()({pageIndex:t,numPages:c})&&l.forEach((n=>{let a,o=0;for(;null!==(a=n.regExp.exec(e));)r.push({keyword:n.regExp,matchIndex:o,pageIndex:t,pageText:e,startIndex:a.index,endIndex:n.regExp.lastIndex}),o++}))})),i(r),r.length>0&&(h(1),k(r[0])),t(r)}))}))};return r.useEffect((()=>{p.current=[]}),[o.current]),{clearKeyword:()=>{t.update("keyword",[d]),v(""),h(0),i([]),m(!1),y(!1)},changeMatchCase:e=>{m(e),s.length>0&&S(s,e,f)},changeWholeWords:e=>{y(e),s.length>0&&S(s,g,e)},currentMatch:u,jumpToMatch:b,jumpToNextMatch:()=>b(u+1),jumpToPreviousMatch:()=>b(u-1),keywords:s,matchCase:g,numberOfMatches:l.length,wholeWords:f,search:()=>S(s,g,f),searchFor:S,setKeywords:c,keyword:0===s.length?"":(C=s[0],C instanceof RegExp?C.source:"string"==typeof C?C:C.keyword),setKeyword:v,setTargetPages:e=>{t.update("targetPageFilter",e)}};var C},E=({children:e,store:t})=>{const n=y(t),[a,o]=r.useState(!1),s=e=>o(!0);return r.useEffect((()=>(t.subscribe("doc",s),()=>{t.unsubscribe("doc",s)})),[]),e({...n,isDocumentLoaded:a})},w=({containerRef:t,store:n})=>{const[a,o]=r.useState(t.current);r.useEffect((()=>{t.current!==a&&o(t.current)}),[]);const s=r.useRef(!1),c=()=>{s.current=!0},l=()=>{s.current=!1},i=r.useCallback((t=>{if(!a)return;if(t.shiftKey||t.altKey||"f"!==t.key)return;(e.isMac()?t.metaKey&&!t.ctrlKey:t.ctrlKey)&&(s.current||document.activeElement&&a.contains(document.activeElement))&&(t.preventDefault(),n.update("areShortcutsPressed",!0))}),[a]);return r.useEffect((()=>{if(a)return document.addEventListener("keydown",i),a.addEventListener("mouseenter",c),a.addEventListener("mouseleave",l),()=>{document.removeEventListener("keydown",i),a.removeEventListener("mouseenter",c),a.removeEventListener("mouseleave",l)}}),[a]),r.createElement(r.Fragment,null)};
/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2024 Nguyen Huu Phuoc <me@phuoc.ng>
 */var b="rpv_be1278b5",v="rpv_119fcec2",k="rpv_ea7700c",S="rpv_4ee9303e",C="rpv_4ee946be",P="rpv_1a0edd04",I="rpv_380e43b3",T="rpv_1e5b198b",M="rpv_e0f04b3e",R="rpv_2013f20d",L="rpv_2014088d";const N=({store:t,onToggle:o})=>{const{l10n:s}=r.useContext(e.LocalizationContext),{direction:c}=r.useContext(e.ThemeContext),[l,i]=r.useState(!1),[u,d]=r.useState(!1),h=c===e.TextDirection.RightToLeft,{clearKeyword:g,changeMatchCase:m,changeWholeWords:p,currentMatch:f,jumpToNextMatch:x,jumpToPreviousMatch:E,keyword:w,matchCase:N,numberOfMatches:_,wholeWords:j,search:K,setKeyword:W}=y(t),O=e=>{i(!0),K().then((t=>{i(!1),d(!0),e&&e()}))};r.useEffect((()=>{const e=t.get("initialKeyword");e&&1===e.length&&w&&O((()=>{t.update("initialKeyword",[])}))}),[]);const D=s&&s.search?s.search.enterToSearch:"Enter to search",B=s&&s.search?s.search.previousMatch:"Previous match",A=s&&s.search?s.search.nextMatch:"Next match",F=s&&s.search?s.search.close:"Close";return r.createElement("div",{className:b},r.createElement("div",{className:v},r.createElement(e.TextBox,{ariaLabel:D,autoFocus:!0,placeholder:D,type:"text",value:w,onChange:e=>{d(!1),W(e)},onKeyDown:e=>{"Enter"===e.key&&w&&(u?x():O())}}),r.createElement("div",{className:e.classNames({[k]:!0,[S]:!h,[C]:h})},l&&r.createElement(e.Spinner,{testId:"search__popover-searching",size:"1rem"}),!l&&r.createElement("span",{"data-testid":"search__popover-num-matches"},f,"/",_))),r.createElement("label",{className:P},r.createElement("input",{className:I,"data-testid":"search__popover-match-case",checked:N,type:"checkbox",onChange:e=>{d(!1),m(e.target.checked)}})," ",s&&s.search?s.search.matchCase:"Match case"),r.createElement("label",{className:P},r.createElement("input",{className:I,checked:j,"data-testid":"search__popover-whole-words",type:"checkbox",onChange:e=>{d(!1),p(e.target.checked)}})," ",s&&s.search?s.search.wholeWords:"Whole words"),r.createElement("div",{className:T},r.createElement("div",{className:M},r.createElement(e.Tooltip,{ariaControlsSuffix:"search-previous-match",position:h?e.Position.BottomRight:e.Position.BottomCenter,target:r.createElement(e.MinimalButton,{ariaLabel:B,isDisabled:f<=1,onClick:E},r.createElement(a,null)),content:()=>B})),r.createElement("div",{className:M},r.createElement(e.Tooltip,{ariaControlsSuffix:"search-next-match",position:e.Position.BottomCenter,target:r.createElement(e.MinimalButton,{ariaLabel:A,isDisabled:f>_-1,onClick:x},r.createElement(n,null)),content:()=>A})),r.createElement("div",{className:e.classNames({[R]:!h,[L]:h})},r.createElement(e.Button,{onClick:()=>{o(),g()}},F))))},_=({children:t,onClick:n})=>{const{l10n:a}=r.useContext(e.LocalizationContext),s=a&&a.search?a.search.search:"Search";return t({icon:r.createElement(o,null),label:s,onClick:n})},j=({enableShortcuts:t,store:n,onClick:a})=>{const o=t?e.isMac()?"Meta+F":"Ctrl+F":"",s=e=>{e&&a()};return r.useEffect((()=>(n.subscribe("areShortcutsPressed",s),()=>{n.unsubscribe("areShortcutsPressed",s)})),[]),r.createElement(_,{onClick:a},(t=>r.createElement(e.Tooltip,{ariaControlsSuffix:"search-popover",position:e.Position.BottomCenter,target:r.createElement(e.MinimalButton,{ariaKeyShortcuts:o,ariaLabel:t.label,testId:"search__popover-button",onClick:a},t.icon),content:()=>t.label})))},K=({children:t,enableShortcuts:n,store:a})=>{const o=t||(e=>r.createElement(j,{enableShortcuts:n,store:a,...e}));return r.createElement(e.Popover,{ariaControlsSuffix:"search",lockScroll:!1,position:e.Position.BottomCenter,target:e=>o({onClick:e}),content:e=>r.createElement(N,{store:a,onToggle:e}),closeOnClickOutside:!1,closeOnEscape:!0})},W=e=>Array.isArray(e)?e.map((e=>x(e))):e?[x(e)]:[];exports.NextIcon=n,exports.PreviousIcon=a,exports.SearchIcon=o,exports.searchPlugin=t=>{const n=r.useMemo((()=>Object.assign({},{enableShortcuts:!0,onHighlightKeyword:()=>{}},t)),[]),a=r.useMemo((()=>e.createStore({initialKeyword:t&&t.keyword?Array.isArray(t.keyword)?t.keyword:[t.keyword]:[],keyword:t&&t.keyword?W(t.keyword):[d],matchPosition:{matchIndex:-1,pageIndex:-1},renderStatus:new Map})),[]),{clearKeyword:o,jumpToMatch:s,jumpToNextMatch:c,jumpToPreviousMatch:l,searchFor:i,setKeywords:u,setTargetPages:h}=y(a),g=e=>r.createElement(K,{enableShortcuts:n.enableShortcuts,...e,store:a});return{install:e=>{const r=t&&t.keyword?Array.isArray(t.keyword)?t.keyword:[t.keyword]:[],n=t&&t.keyword?W(t.keyword):[d];a.update("initialKeyword",r),a.update("jumpToDestination",e.jumpToDestination),a.update("jumpToPage",e.jumpToPage),a.update("keyword",n)},renderPageLayer:e=>r.createElement(p,{key:e.pageIndex,numPages:e.doc.numPages,pageIndex:e.pageIndex,renderHighlights:t?.renderHighlights,store:a,onHighlightKeyword:n.onHighlightKeyword}),renderViewer:e=>{const t=e.slot;return t.subSlot&&(t.subSlot.children=r.createElement(r.Fragment,null,n.enableShortcuts&&r.createElement(w,{containerRef:e.containerRef,store:a}),t.subSlot.children)),t},uninstall:e=>{const t=a.get("renderStatus");t&&t.clear()},onDocumentLoad:e=>{a.update("doc",e.doc)},onTextLayerRender:e=>{let t=a.get("renderStatus");t&&(t=t.set(e.pageIndex,e),a.update("renderStatus",t))},Search:e=>r.createElement(E,{...e,store:a}),ShowSearchPopover:g,ShowSearchPopoverButton:()=>r.createElement(g,null,(e=>r.createElement(j,{enableShortcuts:n.enableShortcuts,store:a,...e}))),clearHighlights:()=>{o()},highlight:e=>{const t=Array.isArray(e)?e:[e];return u(t),i(t)},jumpToMatch:s,jumpToNextMatch:c,jumpToPreviousMatch:l,setTargetPages:h}};
